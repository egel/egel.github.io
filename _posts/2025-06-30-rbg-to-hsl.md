---
layout: post
title: Convert HEX to HSL color
published: true
tags: [algorithm]
# feature-img: "assets/img/feature/pexels-fatih-turan-63325184-8777703.jpg"
---

I wanted to implement a color converter that convers [HEX](weblink-wiki-hex) color value to [HSL](weblink-wiki-hsl). The main reason was to
be able quickly adapt the lightness of the given color, without changing the dye itself.

There are couple of solutions online you can quickly find, but none could also handle conversion from the short color form.
Therefore I wrote one myself.

The method can take long HEX value `#FF00FF` or the short form `#F0F` and convert it into HSL
values.

Here I wrote a _TypeScript_ version of `hexToHsl()` and `hslToColorString()` with some trivial test to check the basic functionality as a reminder for myself in futute:

```ts
/**
 * Expose HSL basic color values
 * @prop {number} h - hue
 * @prop {number} s - saturation
 * @prop {number} l - lightness
 * @interface
 */
export interface ColorHsl {
  h: number;
  s: number;
  l: number;
}

/**
 * Return HSL color params from long or short forms of HEX color value.
 * @returns Result with object contain h, s, l values
 * @throws {Error} If the denominator is zero.
 * @exports
 */
export function hexToHsl(hex: string): ColorHsl {
  const regexHexFull: RegExp = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i;
  const regexHexShort: RegExp = /^#?([a-f\d])([a-f\d])([a-f\d])$/i;

  const resultHexFull = regexHexFull.exec(hex);
  const resultHexShort = regexHexShort.exec(hex);
  let result = resultHexShort || resultHexFull;

  if (resultHexShort) {
    const fullHex =
      resultHexShort[1].repeat(2) + resultHexShort[2].repeat(2) + resultHexShort[3].repeat(2);
    result = regexHexFull.exec(fullHex);
  }

  if (!result) {
    throw new Error("failed parsing hex value");
  }

  const rHex = parseInt(result[1], 16),
    gHex = parseInt(result[2], 16),
    bHex = parseInt(result[3], 16),
    r = rHex / 255,
    g = gHex / 255,
    b = bHex / 255,
    max = Math.max(r, g, b),
    min = Math.min(r, g, b);

  let h: number, s: number, l: number;
  h = s = l = (max + min) / 2;

  if (max === min) {
    // Achromatic
    h = s = 0;
  } else {
    const d = max - min;
    s = l > 0.5 ? d / (2 - max - min) : d / (max + min);
    switch (max) {
      case r:
        h = (g - b) / d + (g < b ? 6 : 0);
        break;
      case g:
        h = (b - r) / d + 2;
        break;
      case b:
        h = (r - g) / d + 4;
        break;
    }
    h /= 6;
  }

  s = Math.round(s * 100);
  l = Math.round(l * 100);
  h = Math.round(h * 360);

  return { h, s, l };
}

/**
 * Return color string value from HSL values
 */
export function hslToColorString(hsl: ColorHsl) {
  return `hsl(${hsl.h}, ${hsl.s}%, ${hsl.l}%)`;
}
```

with very simple tests set

```ts
describe("hexToHsl method", () => {
  it("return hsl h=4.11 s=89.62 l=58.43 from HEX value #F44336", () => {
    const hex = "#f44336";
    const result = {
      h: 4,
      s: 90,
      l: 58,
    };
    expect(hexToHsl(hex)).toStrictEqual(result);
  });

  it("return hsl h=60 s=100 l=50 from HEX value #FFFF00", () => {
    const hex = "#FFFF00";
    const result = {
      h: 60,
      s: 100,
      l: 50,
    };
    expect(hexToHsl(hex)).toStrictEqual(result);
  });

  it("return hsl h=60 s=100 l=50 from HEX value #FF0", () => {
    const hex = "#FF0";
    const result = {
      h: 60,
      s: 100,
      l: 50,
    };
    expect(hexToHsl(hex)).toStrictEqual(result);
  });

  it("return hsl h=0 s=100 l=50 from HEX value #F00", () => {
    const hex = "#F00";
    const result = {
      h: 0,
      s: 100,
      l: 50,
    };
    expect(hexToHsl(hex)).toStrictEqual(result);
  });

  it("throw error for input values which are not proper HEX values", () => {
    const error = /failed parsing hex value/;
    const testArr: Array<string> = [
      "#F000",
      "F000",
      "F0000",
      "F0000000",
      "test",
      "#RDFCXZ",
      "#RDX",
    ];

    testArr.forEach((testHex) => {
      expect(() => hexToHsl(testHex)).toThrowError(error);
    });
  });
});
```

[weblink-wiki-hex]: https://en.wikipedia.org/wiki/Hexadecimal
[weblink-wiki-hsl]: https://en.wikipedia.org/wiki/HSL_and_HSV

[img-node-module-joke]: {{ site.baseurl }}/assets/posts/building-offline-docs/node_modules-heaviest-object-universe.jpg
